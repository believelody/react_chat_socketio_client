{"ast":null,"code":"import _regeneratorRuntime from \"/home/yamakasi/React/react_chat_socketio/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/yamakasi/React/react_chat_socketio/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/yamakasi/React/react_chat_socketio/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/home/yamakasi/React/react_chat_socketio/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/yamakasi/React/react_chat_socketio/src/components/chats/Chat.jsx\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  position: relative;\\n  overflow: hidden;\\n  height: 100vh;\\n\\n  @media \", \" {\\n    width: 100vw;\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport MessageForm from \"../forms/MessageForm\";\nimport MessageList from \"../messages/MessageList\";\nimport ChatHeader from \"../header/ChatHeader\";\nimport Dropdown from \"../dropdown/Dropdown\";\nimport DropdownItem from \"../dropdown/DropdownItem\";\nimport { useAppHooks } from \"../../contexts\";\nimport devices from \"../../utils/devices\";\nimport api from \"../../api\";\nimport NotFriend from \"../friends/NotFriend\";\nimport { DELETE_CHAT } from \"../../reducers/chatReducer\";\nimport { socketOn } from \"../../socket\";\nvar ChatStyle = styled.div(_templateObject(), devices.mobileL);\n\nvar Chat = function Chat(_ref) {\n  var id = _ref.id;\n\n  var _useAppHooks = useAppHooks(),\n      useTransition = _useAppHooks.useTransition,\n      useAuth = _useAppHooks.useAuth,\n      socket = _useAppHooks.socket;\n\n  var _useAuth = _slicedToArray(useAuth, 2),\n      user = _useAuth[0].user,\n      dispatchAuth = _useAuth[1];\n\n  var _useTransition = _slicedToArray(useTransition, 2),\n      chatSelected = _useTransition[0].chatSelected,\n      _ = _useTransition[1];\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      chat = _useState2[0],\n      setChat = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      y = _useState4[0],\n      setY = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isDisplayed = _useState6[0],\n      setDisplay = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var getHeaderPosition = function getHeaderPosition(isDisplayed, y) {\n    setDisplay(isDisplayed);\n    setY(y);\n  };\n\n  socketOn('fetch-chat', socket, chat, function (data, chat) {\n    console.log(data);\n\n    if (data.chat.id === chat.id) {\n      setChat(data.chat);\n    }\n  });\n  useEffect(function () {\n    var fetchChat =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return api.chat.getChat(id);\n\n              case 3:\n                res = _context.sent;\n                setChat(res.data);\n                setLoading(false);\n                _context.next = 12;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                console.log(_context.t0.response.data);\n                setLoading(false);\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n\n      return function fetchChat() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    if (!chat) fetchChat();\n  }, []);\n  console.log(chat);\n  return React.createElement(ChatStyle, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, loading && React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, \"Loading...\"), !loading && !chat && React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, \"Error while fetching\"), !loading && chat && React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, React.createElement(ChatHeader, {\n    getHeaderPosition: getHeaderPosition,\n    isDisplayed: isDisplayed,\n    users: chat.users.filter(function (u) {\n      return u.name !== user.name;\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }), React.createElement(Dropdown, {\n    propsY: y,\n    isDisplayed: isDisplayed,\n    handleDropdown: setDisplay,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, React.createElement(DropdownItem, {\n    handleClick: function handleClick() {\n      return setDisplay(false);\n    },\n    text: \"Add User to Chat\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  })), React.createElement(MessageList, {\n    messages: chat.messages,\n    users: chat.users,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }), chat.users.length === 2 && chat.messages.length > 0 && React.createElement(NotFriend, {\n    contact: chat.users.find(function (u) {\n      return u.name !== user.name;\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }), React.createElement(MessageForm, {\n    chatId: chat.id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  })));\n};\n\nexport default Chat;","map":{"version":3,"sources":["/home/yamakasi/React/react_chat_socketio/src/components/chats/Chat.jsx"],"names":["React","useState","useEffect","styled","MessageForm","MessageList","ChatHeader","Dropdown","DropdownItem","useAppHooks","devices","api","NotFriend","DELETE_CHAT","socketOn","ChatStyle","div","mobileL","Chat","id","useTransition","useAuth","socket","user","dispatchAuth","chatSelected","_","chat","setChat","y","setY","isDisplayed","setDisplay","loading","setLoading","getHeaderPosition","data","console","log","fetchChat","getChat","res","response","users","filter","u","name","messages","length","find"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport MessageForm from \"../forms/MessageForm\";\r\nimport MessageList from \"../messages/MessageList\";\r\nimport ChatHeader from \"../header/ChatHeader\";\r\nimport Dropdown from \"../dropdown/Dropdown\";\r\nimport DropdownItem from \"../dropdown/DropdownItem\";\r\nimport { useAppHooks } from \"../../contexts\";\r\nimport devices from \"../../utils/devices\";\r\nimport api from \"../../api\";\r\nimport NotFriend from \"../friends/NotFriend\";\r\nimport { DELETE_CHAT } from \"../../reducers/chatReducer\";\r\nimport { socketOn } from \"../../socket\";\r\n\r\nconst ChatStyle = styled.div`\r\n  width: 100%;\r\n  position: relative;\r\n  overflow: hidden;\r\n  height: 100vh;\r\n\r\n  @media ${devices.mobileL} {\r\n    width: 100vw;\r\n  }\r\n`;\r\n\r\nconst Chat = ({ id }) => {\r\n  const { useTransition, useAuth, socket } = useAppHooks();\r\n  const [{user}, dispatchAuth] = useAuth\r\n  const [{ chatSelected }, _] = useTransition;\r\n\r\n  const [chat, setChat] = useState(null);\r\n  const [y, setY] = useState(0);\r\n  const [isDisplayed, setDisplay] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const getHeaderPosition = (isDisplayed, y) => {\r\n    setDisplay(isDisplayed);\r\n    setY(y);\r\n  };\r\n\r\n  socketOn('fetch-chat', socket, chat, (data, chat) => {\r\n    console.log(data)\r\n    if (data.chat.id === chat.id) {\r\n      setChat(data.chat)\r\n    }\r\n  })\r\n  \r\n  useEffect(() => {\r\n    const fetchChat = async () => {\r\n      try {\r\n        const res = await api.chat.getChat(id)\r\n        setChat(res.data)\r\n        setLoading(false)\r\n      } catch (error) {\r\n        console.log(error.response.data)\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    if (!chat) fetchChat()\r\n  }, []);\r\n\r\n  console.log(chat)\r\n \r\n  return (\r\n    <ChatStyle>\r\n      {\r\n        loading && <h3>Loading...</h3>\r\n      }\r\n      {\r\n        !loading && !chat && <h3>Error while fetching</h3>\r\n      }\r\n      {!loading && chat && (\r\n        <div>\r\n          <ChatHeader\r\n            getHeaderPosition={getHeaderPosition}\r\n            isDisplayed={isDisplayed}\r\n            users={chat.users.filter(u => u.name !== user.name)}\r\n          />\r\n          <Dropdown\r\n            propsY={y}\r\n            isDisplayed={isDisplayed}\r\n            handleDropdown={setDisplay}\r\n          >\r\n            <DropdownItem\r\n              handleClick={() => setDisplay(false)}\r\n              text=\"Add User to Chat\"\r\n            />\r\n          </Dropdown>\r\n          <MessageList messages={chat.messages} users={chat.users} />\r\n          {\r\n            chat.users.length === 2 && chat.messages.length > 0 &&\r\n            <NotFriend contact={chat.users.find(u => u.name !== user.name)} />\r\n          }\r\n          <MessageForm chatId={chat.id} />\r\n        </div>\r\n      )}\r\n    </ChatStyle>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n"]},"metadata":{},"sourceType":"module"}