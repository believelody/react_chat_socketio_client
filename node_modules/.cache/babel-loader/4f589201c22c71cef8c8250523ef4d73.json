{"ast":null,"code":"import _slicedToArray from \"/home/yamakasi/React/react_chat_socketio/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/home/yamakasi/React/react_chat_socketio/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/yamakasi/React/react_chat_socketio/src/components/messages/MessageList.jsx\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  margin: 50px 0px 140px;\\n  padding: 10px 10px 10px;\\n  display: block;\\n  list-style: none;\\n  height: calc(100vh - 130px);\\n  width: 100%;\\n  position: relative;\\n  bottom: 0;\\n  overflow-y: auto;\\n  scroll-behavior: smooth;\\n  border: 1px solid red;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport MessageItem from \"./MessageItem\";\nimport { useAppHooks } from \"../../contexts\";\nimport { socketOn } from \"../../socket\";\nvar MessageListStyle = styled.ul(_templateObject());\n\nvar MessageList = function MessageList(_ref) {\n  var chat = _ref.chat;\n\n  var _useAppHooks = useAppHooks(),\n      useAuth = _useAppHooks.useAuth,\n      socket = _useAppHooks.socket;\n\n  var _useAuth = _slicedToArray(useAuth, 2),\n      user = _useAuth[0].user,\n      _ = _useAuth[1];\n\n  var messagesRef = React.useRef();\n\n  var _useState = useState(chat.messages),\n      _useState2 = _slicedToArray(_useState, 2),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  var _useState3 = useState(chat.users),\n      _useState4 = _slicedToArray(_useState3, 2),\n      users = _useState4[0],\n      setUsers = _useState4[1];\n\n  var contact = users.find(function (u) {\n    return u.name !== user.name;\n  });\n  socketOn('fetch-messages', socket, messages, function (data, messages) {\n    if (data.chatId === chat.id && messages.length !== data.messages.length) {\n      setMessages(data.messages);\n    }\n  });\n  useEffect(function () {\n    if (messagesRef) {\n      messagesRef.current.scrollTo(0, window.screen.width * 2);\n    }\n  }, [messages]);\n  return React.createElement(MessageListStyle, {\n    ref: messagesRef,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }, messages.length > 0 && messages.map(function (message, i) {\n    return React.createElement(MessageItem, {\n      key: i,\n      contact: contact,\n      message: message,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47\n      },\n      __self: this\n    });\n  }));\n};\n\nexport default MessageList;","map":{"version":3,"sources":["/home/yamakasi/React/react_chat_socketio/src/components/messages/MessageList.jsx"],"names":["React","useState","useEffect","styled","MessageItem","useAppHooks","socketOn","MessageListStyle","ul","MessageList","chat","useAuth","socket","user","_","messagesRef","useRef","messages","setMessages","users","setUsers","contact","find","u","name","data","chatId","id","length","current","scrollTo","window","screen","width","map","message","i"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,SAASC,WAAT,QAA4B,gBAA5B;AACA,SAASC,QAAT,QAAyB,cAAzB;AAEA,IAAMC,gBAAgB,GAAGJ,MAAM,CAACK,EAAV,mBAAtB;;AAcA,IAAMC,WAAW,GAAG,SAAdA,WAAc,OAAc;AAAA,MAAXC,IAAW,QAAXA,IAAW;;AAAA,qBACJL,WAAW,EADP;AAAA,MACxBM,OADwB,gBACxBA,OADwB;AAAA,MACfC,MADe,gBACfA,MADe;;AAAA,gCAEbD,OAFa;AAAA,MAExBE,IAFwB,eAExBA,IAFwB;AAAA,MAElBC,CAFkB;;AAGhC,MAAMC,WAAW,GAAGf,KAAK,CAACgB,MAAN,EAApB;;AAHgC,kBAKAf,QAAQ,CAACS,IAAI,CAACO,QAAN,CALR;AAAA;AAAA,MAKzBA,QALyB;AAAA,MAKfC,WALe;;AAAA,mBAMNjB,QAAQ,CAACS,IAAI,CAACS,KAAN,CANF;AAAA;AAAA,MAMzBA,KANyB;AAAA,MAMlBC,QANkB;;AAOhC,MAAMC,OAAO,GAAGF,KAAK,CAACG,IAAN,CAAW,UAAAC,CAAC;AAAA,WAAIA,CAAC,CAACC,IAAF,KAAWX,IAAI,CAACW,IAApB;AAAA,GAAZ,CAAhB;AAEAlB,EAAAA,QAAQ,CAAC,gBAAD,EAAmBM,MAAnB,EAA2BK,QAA3B,EAAqC,UAACQ,IAAD,EAAOR,QAAP,EAAoB;AAC/D,QAAIQ,IAAI,CAACC,MAAL,KAAgBhB,IAAI,CAACiB,EAArB,IAA2BV,QAAQ,CAACW,MAAT,KAAoBH,IAAI,CAACR,QAAL,CAAcW,MAAjE,EAAyE;AACvEV,MAAAA,WAAW,CAACO,IAAI,CAACR,QAAN,CAAX;AACD;AACF,GAJO,CAAR;AAMAf,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIa,WAAJ,EAAiB;AACfA,MAAAA,WAAW,CAACc,OAAZ,CAAoBC,QAApB,CAA6B,CAA7B,EAAgCC,MAAM,CAACC,MAAP,CAAcC,KAAd,GAAsB,CAAtD;AACD;AACF,GAJQ,EAIN,CAAChB,QAAD,CAJM,CAAT;AAMA,SACE,oBAAC,gBAAD;AAAkB,IAAA,GAAG,EAAEF,WAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGE,QAAQ,CAACW,MAAT,GAAkB,CAAlB,IACCX,QAAQ,CACLiB,GADH,CACO,UAACC,OAAD,EAAUC,CAAV;AAAA,WACH,oBAAC,WAAD;AAAa,MAAA,GAAG,EAAEA,CAAlB;AAAqB,MAAA,OAAO,EAAEf,OAA9B;AAAuC,MAAA,OAAO,EAAEc,OAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADG;AAAA,GADP,CAFJ,CADF;AASD,CA9BD;;AAgCA,eAAe1B,WAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport MessageItem from \"./MessageItem\";\r\nimport { useAppHooks } from \"../../contexts\";\r\nimport { socketOn } from \"../../socket\";\r\n\r\nconst MessageListStyle = styled.ul`\r\n  margin: 50px 0px 140px;\r\n  padding: 10px 10px 10px;\r\n  display: block;\r\n  list-style: none;\r\n  height: calc(100vh - 130px);\r\n  width: 100%;\r\n  position: relative;\r\n  bottom: 0;\r\n  overflow-y: auto;\r\n  scroll-behavior: smooth;\r\n  border: 1px solid red;\r\n`;\r\n\r\nconst MessageList = ({ chat }) => {\r\n  const { useAuth, socket } = useAppHooks()\r\n  const [{user},_] = useAuth\r\n  const messagesRef = React.useRef();\r\n  \r\n  const [messages, setMessages] = useState(chat.messages)\r\n  const [users, setUsers] = useState(chat.users)\r\n  const contact = users.find(u => u.name !== user.name);\r\n\r\n  socketOn('fetch-messages', socket, messages, (data, messages) => {\r\n    if (data.chatId === chat.id && messages.length !== data.messages.length) {\r\n      setMessages(data.messages)\r\n    }\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (messagesRef) {\r\n      messagesRef.current.scrollTo(0, window.screen.width * 2)\r\n    }\r\n  }, [messages])\r\n\r\n  return (\r\n    <MessageListStyle ref={messagesRef}>\r\n      {messages.length > 0 &&\r\n        messages\r\n          .map((message, i) => (\r\n            <MessageItem key={i} contact={contact} message={message} />\r\n          ))}\r\n    </MessageListStyle>\r\n  );\r\n};\r\n\r\nexport default MessageList;\r\n"]},"metadata":{},"sourceType":"module"}