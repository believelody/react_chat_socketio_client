{"ast":null,"code":"import _slicedToArray from \"/home/yamakasi/React/react_chat_socketio/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/home/yamakasi/React/react_chat_socketio/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/yamakasi/React/react_chat_socketio/src/components/friends/NotFriend.jsx\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    text-align: center;\\n    background-color: transparent;\\n    color: black;\\n    position: absolute;\\n    padding: 5px 0px;\\n    width: 100%;\\n    height: auto;\\n    bottom: 80px;\\n    left: 50%;\\n    transform: translate3d(-50%, 0, 0);\\n\\n    & .blocked-request {\\n        margin-left: 10px;\\n        text-transform: uppercase;\\n        // border-radius: 4px;\\n        box-shadow: 2px 2px 4px rgba(0, 0, 0, .4);\\n    }\\n\\n    & .or {\\n        margin: 0px 4px 0px 8px;\\n    }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useEffect, useState } from 'react';\nimport { Button } from 'semantic-ui-react';\nimport styled from 'styled-components';\nimport { useAppHooks } from '../../contexts';\nimport api from '../../api';\nimport { socketEmit, socketOn } from '../../socket';\nvar NotFriendStyle = styled.div(_templateObject());\n\nvar NotFriend = function NotFriend(_ref) {\n  var contact = _ref.contact;\n\n  var _useAppHooks = useAppHooks(),\n      useAuth = _useAppHooks.useAuth,\n      socket = _useAppHooks.socket;\n\n  var _useAuth = _slicedToArray(useAuth, 2),\n      user = _useAuth[0].user,\n      _ = _useAuth[1];\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isFriend = _useState2[0],\n      setIsFriend = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isRequest = _useState4[0],\n      setIsRequest = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      hasBlocked = _useState6[0],\n      setHasBlock = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      isBlocked = _useState8[0],\n      setIsBlock = _useState8[1];\n\n  var checkResponse = function checkResponse(data, user, cb) {\n    if (!data) {\n      cb(false);\n    } else if (data.id === user.id) {\n      cb(true);\n    }\n  };\n\n  var unblockContact = function unblockContact() {\n    alert('contact blocked'); // socketEmit('check-is-blocked', socket, {contactId: contact.id, userId: user.id})\n    // socketEmit('check-has-blocked', socket, {contactId: contact.id, userId: user.id})\n  };\n\n  var blockContact = function blockContact() {\n    alert('contact blocked'); // socketEmit('check-is-blocked', socket, {contactId: contact.id, userId: user.id})\n    // socketEmit('check-has-blocked', socket, {contactId: contact.id, userId: user.id})\n  };\n\n  var acceptContact = function acceptContact() {\n    socketEmit('new-friend', socket, {\n      contactId: contact.id,\n      userId: user.id\n    });\n    socketOn('new-friend-confirm', socket, user, function (data, user) {\n      if (data.from.id === user.id) setIsFriend(true);\n      if (data.from.id === user.id) setIsRequest(false);\n    }); // socketEmit('check-friend', socket, {contactId: contact.id, userId: user.id})\n    // socketEmit('check-request', socket, {contactId: contact.id, userId: user.id})\n  };\n\n  socketOn('check-friend-response', socket, contact, function (data, contact) {\n    return checkResponse(data, contact, setIsFriend);\n  });\n  socketOn('check-request-response', socket, contact, function (data, contact) {\n    return checkResponse(data, contact, setIsRequest);\n  }); // socketOn('check-is-blocked-response', socket, user, (data, user) => checkResponse(data, user, setIsBlock))\n  // socketOn('check-has-blocked-response', socket, contact, (data, contact) => checkResponse(data, contact, setHasBlock))\n\n  useEffect(function () {\n    socketEmit('check-friend', socket, {\n      contactId: contact.id,\n      userId: user.id\n    });\n    socketEmit('check-request', socket, {\n      contactId: contact.id,\n      userId: user.id\n    }); // socketEmit('check-is-blocked', socket, {contactId: contact.id, userId: user.id})\n    // socketEmit('check-has-blocked', socket, {contactId: contact.id, userId: user.id})\n  }, []);\n  return React.createElement(NotFriendStyle, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, !isFriend && !isRequest && !hasBlocked && !isBlocked && React.createElement(\"span\", {\n    className: \"not-friend\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, \"This contact is not among your friends. Do you want to block him?\", React.createElement(Button, {\n    className: \"blocked-request\",\n    onClick: blockContact,\n    content: React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, \"Yes\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  })), !isFriend && isRequest && !hasBlocked && !isBlocked && React.createElement(\"span\", {\n    className: \"not-friend\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, \"This contact sent you a friend's request. What do you want to do?\", React.createElement(Button, {\n    className: \"blocked-request\",\n    onClick: acceptContact,\n    content: React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \"Accept\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }), React.createElement(\"span\", {\n    className: \"or\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, \"Or\"), React.createElement(Button, {\n    className: \"blocked-request\",\n    onClick: blockContact,\n    content: React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, \"Block\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  })), !isFriend && !isRequest && hasBlocked && isBlocked && hasBlocked.id === contact.id && React.createElement(\"span\", {\n    className: \"not-friend\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, \"This contact has been blocked. You Do you want to unblock him?\", React.createElement(Button, {\n    className: \"blocked-request\",\n    onClick: unblockContact,\n    content: React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \"Yes\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  })), !isFriend && !isRequest && hasBlocked && isBlocked && isBlocked.id === user.id && React.createElement(\"span\", {\n    className: \"not-friend\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, \"You can no longer send message in this chat!\"));\n};\n\nexport default NotFriend;","map":{"version":3,"sources":["/home/yamakasi/React/react_chat_socketio/src/components/friends/NotFriend.jsx"],"names":["React","useEffect","useState","Button","styled","useAppHooks","api","socketEmit","socketOn","NotFriendStyle","div","NotFriend","contact","useAuth","socket","user","_","isFriend","setIsFriend","isRequest","setIsRequest","hasBlocked","setHasBlock","isBlocked","setIsBlock","checkResponse","data","cb","id","unblockContact","alert","blockContact","acceptContact","contactId","userId","from"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { Button } from 'semantic-ui-react'\nimport styled from 'styled-components'\nimport { useAppHooks } from '../../contexts';\nimport api from '../../api';\nimport { socketEmit, socketOn } from '../../socket';\n\nconst NotFriendStyle = styled.div`\n    text-align: center;\n    background-color: transparent;\n    color: black;\n    position: absolute;\n    padding: 5px 0px;\n    width: 100%;\n    height: auto;\n    bottom: 80px;\n    left: 50%;\n    transform: translate3d(-50%, 0, 0);\n\n    & .blocked-request {\n        margin-left: 10px;\n        text-transform: uppercase;\n        // border-radius: 4px;\n        box-shadow: 2px 2px 4px rgba(0, 0, 0, .4);\n    }\n\n    & .or {\n        margin: 0px 4px 0px 8px;\n    }\n`\n\nconst NotFriend = ({ contact }) => {\n    const { useAuth, socket } = useAppHooks()\n    const [{user}, _] = useAuth\n\n    const [isFriend, setIsFriend] = useState(false)\n    const [isRequest, setIsRequest] = useState(false)\n    const [hasBlocked, setHasBlock] = useState(false)\n    const [isBlocked, setIsBlock] = useState(false)\n\n    const checkResponse = (data, user, cb) => {\n        if (!data) {\n            cb(false)\n        }\n        else if (data.id === user.id) {\n            cb(true)\n        }\n    }\n\n    const unblockContact = () => {\n        alert('contact blocked')\n        // socketEmit('check-is-blocked', socket, {contactId: contact.id, userId: user.id})\n        // socketEmit('check-has-blocked', socket, {contactId: contact.id, userId: user.id})\n    }\n\n    const blockContact = () => {\n        alert('contact blocked')\n        // socketEmit('check-is-blocked', socket, {contactId: contact.id, userId: user.id})\n        // socketEmit('check-has-blocked', socket, {contactId: contact.id, userId: user.id})\n    }\n    \n    const acceptContact = () => {\n        socketEmit('new-friend', socket, { contactId: contact.id, userId: user.id })\n        socketOn('new-friend-confirm', socket, user, (data, user) => {\n            if (data.from.id === user.id) setIsFriend(true)\n            if (data.from.id === user.id) setIsRequest(false)\n        })\n        // socketEmit('check-friend', socket, {contactId: contact.id, userId: user.id})\n        // socketEmit('check-request', socket, {contactId: contact.id, userId: user.id})\n    }\n\n    socketOn('check-friend-response', socket, contact, (data, contact) => checkResponse(data, contact, setIsFriend))\n    socketOn('check-request-response', socket, contact, (data, contact) => checkResponse(data, contact, setIsRequest))\n    // socketOn('check-is-blocked-response', socket, user, (data, user) => checkResponse(data, user, setIsBlock))\n    // socketOn('check-has-blocked-response', socket, contact, (data, contact) => checkResponse(data, contact, setHasBlock))\n\n    useEffect(() => {\n        socketEmit('check-friend', socket, {contactId: contact.id, userId: user.id})\n        socketEmit('check-request', socket, {contactId: contact.id, userId: user.id})\n        // socketEmit('check-is-blocked', socket, {contactId: contact.id, userId: user.id})\n        // socketEmit('check-has-blocked', socket, {contactId: contact.id, userId: user.id})\n    }, [])\n\n    return (\n        <NotFriendStyle>\n            {\n                !isFriend && !isRequest && !hasBlocked && !isBlocked &&\n                <span className='not-friend'>\n                    This contact is not among your friends. Do you want to block him?\n                    <Button className='blocked-request' onClick={blockContact} content={<b>Yes</b>} />\n                </span>\n            }\n            {\n                !isFriend && isRequest && !hasBlocked && !isBlocked &&\n                <span className='not-friend'>\n                    This contact sent you a friend's request. What do you want to do?\n                    <Button className='blocked-request' onClick={acceptContact} content={<b>Accept</b>} />\n                    <span className='or'>Or</span>\n                    <Button className='blocked-request' onClick={blockContact} content={<b>Block</b>} />\n                </span>\n            }\n            {\n                !isFriend && !isRequest && hasBlocked && isBlocked && hasBlocked.id === contact.id &&\n                <span className='not-friend'>\n                    This contact has been blocked. You Do you want to unblock him?\n                    <Button className='blocked-request' onClick={unblockContact} content={<b>Yes</b>} />\n                </span>\n            }\n            {\n                !isFriend && !isRequest && hasBlocked && isBlocked && isBlocked.id === user.id &&\n                <span className='not-friend'>\n                    You can no longer send message in this chat!\n                </span>\n            }\n        </NotFriendStyle>\n    )\n}\n\nexport default NotFriend\n"]},"metadata":{},"sourceType":"module"}